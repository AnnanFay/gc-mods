Full rewrite, enjoy. Experimental support for Google Chrome.